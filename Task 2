-- # TASK-2 # --

/*IN THE INVENTORY STRUCTURE DISPLAY:
1) PID, PDESC, CATEGORY, SNAME, SCITY
2) DISPLAY OID, ODATE, CNAME, CADDRESS, CPHONE, PDESC, PRICE,OQTY, AMT
3 IN THE INVENTORY STRUCTURE CREATE A PROCEDURE TO VIEW BILL, GIVEN AN ORDER ID. 
IT SHOULD DISPLAY OID,ODATE,CID,CNAME, PID,PDESC, PRICE, OQTY, AMOUNT*/

USE INVENTORY;

SELECT PRODUCT.PID, PDESC, CATEGORY, SNAME, SCITY
FROM PRODUCT
INNER JOIN SUPPLIER
ON PRODUCT.SID = SUPPLIER.SID;

--------------------

SELECT ORDERS.OID, ODATE, CNAME, CADDR, CPHONE, 
	   PDESC, PRICE, OQTY, (PRICE*OQTY) AS 'AMOUNT'
FROM ORDERS 
INNER JOIN CUSTOMER
ON ORDERS.CID = CUSTOMER.CID
INNER JOIN PRODUCT
ON ORDERS.PID = PRODUCT.PID;

--------------------
CREATE PROCEDURE BILL(@OID AS CHAR(5))
AS
BEGIN
	SELECT CUSTOMER.CID,CNAME,OID,ODATE,ORDERS.PID,PDESC,OQTY,PRICE AS PRICE_PER_QTY, OQTY*PRICE AS TOTAL_AMOUNT
	FROM CUSTOMER
  INNER JOIN ORDERS 
  ON CUSTOMER.CID=ORDERS.CID 
  INNER JOIN PRODUCT 
  ON PRODUCT.PID=ORDERS.PID 
  WHERE OID=@OID;
END;

-- CHECKING THE CREATED PROCEDURE	
BILL 'O0001';
